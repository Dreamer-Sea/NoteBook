# Redis



# 管道(Pipeline)
## 什么是RTT(Round Trip Time)
从发出端发出消息到发出端接收到接收端发出的确认消息之间的时间，被称为RTT。建立TCP连接需要经历2个RTT。

Redis是一种基于客户端-服务端模型(C/S模型)以及请求/响应协议的TCP服务。所以Redis在通常情况下发送一个请求会遵循以下步骤：
1. 客户端向服务端发送一个查询请求，并监听Socket返回，通常是以阻塞模式，等待服务端响应。
2. 服务端处理请求，并将结果返回给客户端。

**所以一般情况下Redis的每个命令都会经历一个请求(一个RTT)。**（可以类比HTTP 1.0协议中的短连接，即每次请求都会建立一个TCP连接。）

在以上的情况下，如果Redis执行大量的命令时就会耗费很多时间在RTT上。所以需要使用**管道**来解决这个问题。管道能够在一个请求中执行多于1条的命令，这样就能够大大的节省时间。

**缺点：**使用管道后，就要求服务端用一个回复队列来回复管道传递过来的命令，回复队列需要占用一定的内存空间，所以当客户端发送过来的命令特别多的时候，就需要对命令进行合理的分组，不然服务端就需要用很大的内存空间来存放回复队列。

