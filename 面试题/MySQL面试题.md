# MySQL面试题

# 索引的缺点
1. 降低了更新速度，每次更新表的数据就要更新索引。
2. 索引会占据一定的物理空间，如果在大表上创建了多种组合索引，那么索引文件会膨胀很快。
3. 如果使用索引的列存在很多重复的数据，那么索引的效果就不明显。
4. 数据量少的表，走全表搜索更高效。

# 聚簇索引的限制
1. 插入速度**严重依赖于**插入顺序，按照主键的顺序插入是最快的方式。
2. 更新主键的代价很高，一般定义主键不可更新。
3. 二级索引访问需要两次索引查找。
4. 主键建议使用整型。

# 如何排查MySQL执行慢的原因
## 查询慢查询的数量
MySQL的慢查询数量保存在MySQL数据库的**slow_log表**。
```sql
SELECT * FROM slow_log where start_time > '2019/05/19 00:00:00';
```
## 查看当前进行的查询状态
```sql
select * from information_schema.processlist；
```

## 操作系统问题

# 一张表，里面有 ID 自增主键，当 insert 了 17 条记录之后，删除了第 15,16,17 条记录，再把 MySQL 重启，再 insert 一条记录，这条记录的 ID 是 18 还是 15？
这个需要分使用的数据引擎讨论。
## InnoDB
在InnoDB的时候，答案是15。因为重启MySQL或对表进行优化(OPTIMIZE)操作，都会导致最大ID丢失。
## MyISAM
在使用MyISAM的时候，答案是18。因为MyISAM表会将自增主键的最大ID记录到数据文件里面。重启MySQL也不会令这个ID丢失。

# 如果表中有大字段，且该字段不经常更新，请问需不需要拆表？
分别讨论拆和不拆带来的问题。在实际中，会采取拆的方案。
## 拆
如果拆表，那么会带来**连接消耗** + **存储拆分空间**这两个问题。
## 不拆
如果不拆表，那就会影响**查询性能**。

