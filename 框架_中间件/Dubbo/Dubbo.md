# Dubbo

# 什么是Dubbo
Dubbo是一个高性能、轻量级的开源Java RPC框架。
它的三大核心能力分别是：
1. 面向接口的远程方法调用。
2. 只能容错。
3. 负载均衡。

![Dubbo框架图](/框架和库/Dubbo/pictures/Dubbo框架图.jpg)

# 什么是RPC(Remote Procedure Call， 远程过程调用)
通过网络调用远程计算机程序上的服务。这其中不需要了解底层网络技术的协议。

![RPC原理](/框架和库/Dubbo/pictures/RPC原理.jpg)

# 为什么需要Dubbo
Dubbo的出现跟SOA(面向服务)分布式架构的流行有着很大的关系。在SOA中，工程需要根据业务逻辑拆分成服务层和表现层两个工程，服务层负责对外提供服务，表现层负责处理和页面的交互。而随着工程越来越复杂，工程中的服务层和表现层会越来越多，每次的相互调用都需要编写相应的RPC代码会使得工程内部的耦合性极高，同时单纯的RPC仅仅是调用服务而没有能力处理由其带来的问题。
这时候Dubbo就能够体现出它的价值了。Dubbo主要有以下四点特性：
1. 负载均衡：能够将同一个服务部署在不同的服务器上，然后根据服务器的情况，决定每个服务器上处理多少请求。
2. 服务调用链路生成：不需要手动从零开始建立调用链路，表现层只需要说明自己调用哪个服务层就行，剩下的工作交由Dubbo完成。
3. 服务访问压力以及时长统计、资源调度和治理：Dubbo能够监控各个服务的情况，并且有相应的管理方法，这样能够提高集群的利用率。
4. 服务降级：由于集群的存在，如果有机器离线了也不会影响客户端的使用。

# 什么是分布式？
将当个服务器上的单个程序，按照一定的方法进行拆分(例如按照功能进行拆分)，然后将拆分后的子工程部署在不同的机器上，从而降低单个服务器的压力，同时能够提高整个工程的性能。

# 为什么需要分布式？
1. 能够横向的提高工程的性能表现。
2. 降低工程内部的耦合性，有利于工程的维护。
3. 降低了工程的扩展难度。

# ZooKeeper宕机与Dubbo直连的情况
在实际生产中，假如ZooKeeper注册中心宕掉，一段时间内服务消费方还是能够调用提供方的服务，实际上它使用了**本地缓存**进行通讯。

## Dubbo健壮性的表现
1. 监控中心宕掉不影响使用，只是丢失部分采样数据。
2. 数据库宕掉后，注册中心仍能通过缓存提供服务列表查询，但不能注册新服务。
3. 注册中心对等集群，任意一台宕掉后，将自动切换到另一台。
4. 注册中心全部宕掉后，服务提供者和服务消费者仍能通过本地缓存通讯。
5. 服务提供者无状态，任意一台宕掉后，不影响使用。
6. 服务提供者全部宕掉后，服务消费者应用将无法使用，并无限次重连等待服务提供者恢复。

# Dubbo的容错机制
1. 失败自动切换。当出现失败时，重试其它服务器。
2. 快速失败。只发起一次调用，失败立即报错。
3. 失败安全。出现异常时，直接忽略。
4. 失败自动恢复。后台记录失败请求，定时重发。
5. 并行调用多个服务器，只要一个成功即返回。
6. 广播调用所有提供者，逐个调用，任意一台报错则报错。